import{m as X,S as oe,J as He,u as G,g as Y,j as A,k as Le,d as g,U as le,b as ve,s as B,x as Fe,N as Be,h as x,V as Ve,Q as y,q as w,H as _e,W as $e,C as De,T as ie}from"./index.a75b80da.js";import{r as ne,b as Me,u as ze,a as Ae}from"./QInput.71eaa411.js";import{v as Oe,d as We}from"./QBtn.80f5b651.js";import{p as I}from"./portal.5c7a12bb.js";import{b as Ke,a as Qe,h as Re}from"./scroll.addc96bd.js";import{h as Ie,b as Ue}from"./dom.cf414058.js";function je(e,t,l){let o;function s(){o!==void 0&&(oe.remove(o),o=void 0)}return X(()=>{e.value===!0&&s()}),{removeFromHistory:s,addToHistory(){o={condition:()=>l.value===!0,handler:t},oe.add(o)}}}function Ne(){let e;const t=Y();function l(){e=void 0}return He(l),X(l),{removeTick:l,registerTick(o){e=o,G(()=>{e===o&&(Oe(t)===!1&&e(),e=void 0)})}}}const Ge={modelValue:{type:Boolean,default:null},"onUpdate:modelValue":[Function,Array]},Xe=["beforeShow","show","beforeHide","hide"];function Ye({showing:e,canShow:t,hideOnRouteChange:l,handleShow:o,handleHide:s,processOnMount:u}){const r=Y(),{props:a,emit:d,proxy:m}=r;let f;function v(n){e.value===!0?q(n):p(n)}function p(n){if(a.disable===!0||n!==void 0&&n.qAnchorHandled===!0||t!==void 0&&t(n)!==!0)return;const h=a["onUpdate:modelValue"]!==void 0;h===!0&&(d("update:modelValue",!0),f=n,G(()=>{f===n&&(f=void 0)})),(a.modelValue===null||h===!1)&&C(n)}function C(n){e.value!==!0&&(e.value=!0,d("beforeShow",n),o!==void 0?o(n):d("show",n))}function q(n){if(a.disable===!0)return;const h=a["onUpdate:modelValue"]!==void 0;h===!0&&(d("update:modelValue",!1),f=n,G(()=>{f===n&&(f=void 0)})),(a.modelValue===null||h===!1)&&V(n)}function V(n){e.value!==!1&&(e.value=!1,d("beforeHide",n),s!==void 0?s(n):d("hide",n))}function P(n){a.disable===!0&&n===!0?a["onUpdate:modelValue"]!==void 0&&d("update:modelValue",!1):n===!0!==e.value&&(n===!0?C:V)(f)}A(()=>a.modelValue,P),l!==void 0&&We(r)===!0&&A(()=>m.$route.fullPath,()=>{l.value===!0&&e.value===!0&&q()}),u===!0&&Le(()=>{P(a.modelValue)});const _={show:p,hide:q,toggle:v};return Object.assign(m,_),_}const Je={transitionShow:{type:String,default:"fade"},transitionHide:{type:String,default:"fade"},transitionDuration:{type:[String,Number],default:300}};function Ze(e,t=()=>{},l=()=>{}){return{transitionProps:g(()=>{const o=`q-transition--${e.transitionShow||t()}`,s=`q-transition--${e.transitionHide||l()}`;return{appear:!0,enterFromClass:`${o}-enter-from`,enterActiveClass:`${o}-enter-active`,enterToClass:`${o}-enter-to`,leaveFromClass:`${s}-leave-from`,leaveActiveClass:`${s}-leave-active`,leaveToClass:`${s}-leave-to`}}),transitionStyle:g(()=>`--q-transition-duration: ${e.transitionDuration}ms`)}}let et=1,tt=document.body;function ot(e,t){const l=document.createElement("div");if(l.id=t!==void 0?`q-portal--${t}--${et++}`:e,le.globalNodes!==void 0){const o=le.globalNodes.class;o!==void 0&&(l.className=o)}return tt.appendChild(l),l}function lt(e){e.remove()}const it=ve({name:"QPortal",setup(e,{slots:t}){return()=>t.default()}});function nt(e){for(e=e.parent;e!=null;){if(e.type.name==="QGlobalDialog")return!0;if(e.type.name==="QDialog"||e.type.name==="QMenu")return!1;e=e.parent}return!1}function st(e,t,l,o){const s=B(!1),u=B(!1);let r=null;const a={},d=o==="dialog"&&nt(e);function m(v){if(v===!0){ne(a),u.value=!0;return}u.value=!1,s.value===!1&&(d===!1&&r===null&&(r=ot(!1,o)),s.value=!0,I.push(e.proxy),Me(a))}function f(v){if(u.value=!1,v!==!0)return;ne(a),s.value=!1;const p=I.indexOf(e.proxy);p!==-1&&I.splice(p,1),r!==null&&(lt(r),r=null)}return Fe(()=>{f(!0)}),e.proxy.__qPortal=!0,Be(e.proxy,"contentEl",()=>t.value),{showPortal:m,hidePortal:f,portalIsActive:s,portalIsAccessible:u,renderPortal:()=>d===!0?l():s.value===!0?[x(Ve,{to:r},x(it,l))]:void 0}}let L=0,U,j,F,N=!1,se,re,ae,b=null;function rt(e){at(e)&&_e(e)}function at(e){if(e.target===document.body||e.target.classList.contains("q-layout__backdrop"))return!0;const t=$e(e),l=e.shiftKey&&!e.deltaX,o=!l&&Math.abs(e.deltaX)<=Math.abs(e.deltaY),s=l||o?e.deltaY:e.deltaX;for(let u=0;u<t.length;u++){const r=t[u];if(Re(r,o))return o?s<0&&r.scrollTop===0?!0:s>0&&r.scrollTop+r.clientHeight===r.scrollHeight:s<0&&r.scrollLeft===0?!0:s>0&&r.scrollLeft+r.clientWidth===r.scrollWidth}return!0}function ue(e){e.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function M(e){N!==!0&&(N=!0,requestAnimationFrame(()=>{N=!1;const{height:t}=e.target,{clientHeight:l,scrollTop:o}=document.scrollingElement;(F===void 0||t!==window.innerHeight)&&(F=l-t,document.scrollingElement.scrollTop=o),o>F&&(document.scrollingElement.scrollTop-=Math.ceil((o-F)/8))}))}function de(e){const t=document.body,l=window.visualViewport!==void 0;if(e==="add"){const{overflowY:o,overflowX:s}=window.getComputedStyle(t);U=Ke(window),j=Qe(window),se=t.style.left,re=t.style.top,ae=window.location.href,t.style.left=`-${U}px`,t.style.top=`-${j}px`,s!=="hidden"&&(s==="scroll"||t.scrollWidth>window.innerWidth)&&t.classList.add("q-body--force-scrollbar-x"),o!=="hidden"&&(o==="scroll"||t.scrollHeight>window.innerHeight)&&t.classList.add("q-body--force-scrollbar-y"),t.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,y.is.ios===!0&&(l===!0?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",M,w.passiveCapture),window.visualViewport.addEventListener("scroll",M,w.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",ue,w.passiveCapture))}y.is.desktop===!0&&y.is.mac===!0&&window[`${e}EventListener`]("wheel",rt,w.notPassive),e==="remove"&&(y.is.ios===!0&&(l===!0?(window.visualViewport.removeEventListener("resize",M,w.passiveCapture),window.visualViewport.removeEventListener("scroll",M,w.passiveCapture)):window.removeEventListener("scroll",ue,w.passiveCapture)),t.classList.remove("q-body--prevent-scroll"),t.classList.remove("q-body--force-scrollbar-x"),t.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,t.style.left=se,t.style.top=re,window.location.href===ae&&window.scrollTo(U,j),F=void 0)}function ut(e){let t="add";if(e===!0){if(L++,b!==null){clearTimeout(b),b=null;return}if(L>1)return}else{if(L===0||(L--,L>0))return;if(t="remove",y.is.ios===!0&&y.is.nativeMobile===!0){b!==null&&clearTimeout(b),b=setTimeout(()=>{de(t),b=null},100);return}}de(t)}function dt(){let e;return{preventBodyScroll(t){t!==e&&(e!==void 0||t===!0)&&(e=t,ut(t))}}}const k=[];let E;function ct(e){E=e.keyCode===27}function ft(){E===!0&&(E=!1)}function mt(e){E===!0&&(E=!1,De(e,27)===!0&&k[k.length-1](e))}function pe(e){window[e]("keydown",ct),window[e]("blur",ft),window[e]("keyup",mt),E=!1}function vt(e){y.is.desktop===!0&&(k.push(e),k.length===1&&pe("addEventListener"))}function ce(e){const t=k.indexOf(e);t!==-1&&(k.splice(t,1),k.length===0&&pe("removeEventListener"))}const T=[];function he(e){T[T.length-1](e)}function pt(e){y.is.desktop===!0&&(T.push(e),T.length===1&&document.body.addEventListener("focusin",he))}function fe(e){const t=T.indexOf(e);t!==-1&&(T.splice(t,1),T.length===0&&document.body.removeEventListener("focusin",he))}let z=0;const ht={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},me={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]};var Tt=ve({name:"QDialog",inheritAttrs:!1,props:{...Ge,...Je,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,backdropFilter:String,position:{type:String,default:"standard",validator:e=>["standard","top","bottom","left","right"].includes(e)}},emits:[...Xe,"shake","click","escapeKey"],setup(e,{slots:t,emit:l,attrs:o}){const s=Y(),u=B(null),r=B(!1),a=B(!1);let d=null,m=null,f,v;const p=g(()=>e.persistent!==!0&&e.noRouteDismiss!==!0&&e.seamless!==!0),{preventBodyScroll:C}=dt(),{registerTimeout:q}=ze(),{registerTick:V,removeTick:P}=Ne(),{transitionProps:_,transitionStyle:n}=Ze(e,()=>me[e.position][0],()=>me[e.position][1]),h=g(()=>n.value+(e.backdropFilter!==void 0?`;backdrop-filter:${e.backdropFilter};-webkit-backdrop-filter:${e.backdropFilter}`:"")),{showPortal:J,hidePortal:Z,portalIsAccessible:ge,renderPortal:ye}=st(s,u,Pe,"dialog"),{hide:$}=Ye({showing:r,hideOnRouteChange:p,handleShow:qe,handleHide:Se,processOnMount:!0}),{addToHistory:we,removeFromHistory:be}=je(r,$,p),xe=g(()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${e.maximized===!0?"maximized":"minimized"} q-dialog__inner--${e.position} ${ht[e.position]}`+(a.value===!0?" q-dialog__inner--animating":"")+(e.fullWidth===!0?" q-dialog__inner--fullwidth":"")+(e.fullHeight===!0?" q-dialog__inner--fullheight":"")+(e.square===!0?" q-dialog__inner--square":"")),D=g(()=>r.value===!0&&e.seamless!==!0),ke=g(()=>e.autoClose===!0?{onClick:Ee}:{}),Te=g(()=>[`q-dialog fullscreen no-pointer-events q-dialog--${D.value===!0?"modal":"seamless"}`,o.class]);A(()=>e.maximized,i=>{r.value===!0&&K(i)}),A(D,i=>{C(i),i===!0?(pt(Q),vt(W)):(fe(Q),ce(W))});function qe(i){we(),m=e.noRefocus===!1&&document.activeElement!==null?document.activeElement:null,K(e.maximized),J(),a.value=!0,e.noFocus!==!0?(document.activeElement!==null&&document.activeElement.blur(),V(H)):P(),q(()=>{if(s.proxy.$q.platform.is.ios===!0){if(e.seamless!==!0&&document.activeElement){const{top:c,bottom:S}=document.activeElement.getBoundingClientRect(),{innerHeight:te}=window,R=window.visualViewport!==void 0?window.visualViewport.height:te;c>0&&S>R/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-R,S>=te?1/0:Math.ceil(document.scrollingElement.scrollTop+S-R/2))),document.activeElement.scrollIntoView()}v=!0,u.value.click(),v=!1}J(!0),a.value=!1,l("show",i)},e.transitionDuration)}function Se(i){P(),be(),ee(!0),a.value=!0,Z(),m!==null&&(((i&&i.type.indexOf("key")===0?m.closest('[tabindex]:not([tabindex^="-"])'):void 0)||m).focus(),m=null),q(()=>{Z(!0),a.value=!1,l("hide",i)},e.transitionDuration)}function H(i){Ae(()=>{let c=u.value;if(c!==null){if(i!==void 0){const S=c.querySelector(i);if(S!==null){S.focus({preventScroll:!0});return}}c.contains(document.activeElement)!==!0&&(c=c.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||c.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||c.querySelector("[autofocus], [data-autofocus]")||c,c.focus({preventScroll:!0}))}})}function O(i){i&&typeof i.focus=="function"?i.focus({preventScroll:!0}):H(),l("shake");const c=u.value;c!==null&&(c.classList.remove("q-animate--scale"),c.classList.add("q-animate--scale"),d!==null&&clearTimeout(d),d=setTimeout(()=>{d=null,u.value!==null&&(c.classList.remove("q-animate--scale"),H())},170))}function W(){e.seamless!==!0&&(e.persistent===!0||e.noEscDismiss===!0?e.maximized!==!0&&e.noShake!==!0&&O():(l("escapeKey"),$()))}function ee(i){d!==null&&(clearTimeout(d),d=null),(i===!0||r.value===!0)&&(K(!1),e.seamless!==!0&&(C(!1),fe(Q),ce(W))),i!==!0&&(m=null)}function K(i){i===!0?f!==!0&&(z<1&&document.body.classList.add("q-body--dialog"),z++,f=!0):f===!0&&(z<2&&document.body.classList.remove("q-body--dialog"),z--,f=!1)}function Ee(i){v!==!0&&($(i),l("click",i))}function Ce(i){e.persistent!==!0&&e.noBackdropDismiss!==!0?$(i):e.noShake!==!0&&O()}function Q(i){e.allowFocusOutside!==!0&&ge.value===!0&&Ue(u.value,i.target)!==!0&&H('[tabindex]:not([tabindex="-1"])')}Object.assign(s.proxy,{focus:H,shake:O,__updateRefocusTarget(i){m=i||null}}),X(ee);function Pe(){return x("div",{role:"dialog","aria-modal":D.value===!0?"true":"false",...o,class:Te.value},[x(ie,{name:"q-transition--fade",appear:!0},()=>D.value===!0?x("div",{class:"q-dialog__backdrop fixed-full",style:h.value,"aria-hidden":"true",tabindex:-1,onClick:Ce}):null),x(ie,_.value,()=>r.value===!0?x("div",{ref:u,class:xe.value,style:n.value,tabindex:-1,...ke.value},Ie(t.default)):null)])}return ye}});export{Tt as Q,Ne as u};
