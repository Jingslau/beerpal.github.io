import{n as Y,W as oe,G as Ce,v as X,E as Le,j as N,k as A,X as He,m as Fe,d as g,b as me,t as B,y as Be,K as _e,h as x,Y as Ve,Z as $e,_ as De,P as y,s as w,L as Me,$ as ze,a0 as Ae,T as le,f as Oe,a1 as Ke}from"./index.4aad8486.js";import{r as ie,b as We,u as Re,a as Qe}from"./QInput.2afb3208.js";import{p as j}from"./portal.7c76c6c6.js";import{b as je,a as Ie,h as Ue}from"./scroll.59fcdce2.js";function Ge(e,t,n){let o;function s(){o!==void 0&&(oe.remove(o),o=void 0)}return Y(()=>{e.value===!0&&s()}),{removeFromHistory:s,addToHistory(){o={condition:()=>n.value===!0,handler:t},oe.add(o)}}}function Xe(){let e;const t=N();function n(){e=void 0}return Ce(n),Y(n),{removeTick:n,registerTick(o){e=o,X(()=>{e===o&&(Le(t)===!1&&e(),e=void 0)})}}}const Ye={modelValue:{type:Boolean,default:null},"onUpdate:modelValue":[Function,Array]},Ne=["beforeShow","show","beforeHide","hide"];function Ze({showing:e,canShow:t,hideOnRouteChange:n,handleShow:o,handleHide:s,processOnMount:u}){const r=N(),{props:a,emit:d,proxy:m}=r;let f;function v(i){e.value===!0?S(i):p(i)}function p(i){if(a.disable===!0||i!==void 0&&i.qAnchorHandled===!0||t!==void 0&&t(i)!==!0)return;const h=a["onUpdate:modelValue"]!==void 0;h===!0&&(d("update:modelValue",!0),f=i,X(()=>{f===i&&(f=void 0)})),(a.modelValue===null||h===!1)&&P(i)}function P(i){e.value!==!0&&(e.value=!0,d("beforeShow",i),o!==void 0?o(i):d("show",i))}function S(i){if(a.disable===!0)return;const h=a["onUpdate:modelValue"]!==void 0;h===!0&&(d("update:modelValue",!1),f=i,X(()=>{f===i&&(f=void 0)})),(a.modelValue===null||h===!1)&&_(i)}function _(i){e.value!==!1&&(e.value=!1,d("beforeHide",i),s!==void 0?s(i):d("hide",i))}function C(i){a.disable===!0&&i===!0?a["onUpdate:modelValue"]!==void 0&&d("update:modelValue",!1):i===!0!==e.value&&(i===!0?P:_)(f)}A(()=>a.modelValue,C),n!==void 0&&He(r)===!0&&A(()=>m.$route.fullPath,()=>{n.value===!0&&e.value===!0&&S()}),u===!0&&Fe(()=>{C(a.modelValue)});const V={show:p,hide:S,toggle:v};return Object.assign(m,V),V}const Je={transitionShow:{type:String,default:"fade"},transitionHide:{type:String,default:"fade"},transitionDuration:{type:[String,Number],default:300}};function et(e,t=()=>{},n=()=>{}){return{transitionProps:g(()=>{const o=`q-transition--${e.transitionShow||t()}`,s=`q-transition--${e.transitionHide||n()}`;return{appear:!0,enterFromClass:`${o}-enter-from`,enterActiveClass:`${o}-enter-active`,enterToClass:`${o}-enter-to`,leaveFromClass:`${s}-leave-from`,leaveActiveClass:`${s}-leave-active`,leaveToClass:`${s}-leave-to`}}),transitionStyle:g(()=>`--q-transition-duration: ${e.transitionDuration}ms`)}}const tt=me({name:"QPortal",setup(e,{slots:t}){return()=>t.default()}});function ot(e){for(e=e.parent;e!=null;){if(e.type.name==="QGlobalDialog")return!0;if(e.type.name==="QDialog"||e.type.name==="QMenu")return!1;e=e.parent}return!1}function lt(e,t,n,o){const s=B(!1),u=B(!1);let r=null;const a={},d=o==="dialog"&&ot(e);function m(v){if(v===!0){ie(a),u.value=!0;return}u.value=!1,s.value===!1&&(d===!1&&r===null&&(r=$e(!1,o)),s.value=!0,j.push(e.proxy),We(a))}function f(v){if(u.value=!1,v!==!0)return;ie(a),s.value=!1;const p=j.indexOf(e.proxy);p!==-1&&j.splice(p,1),r!==null&&(De(r),r=null)}return Be(()=>{f(!0)}),e.proxy.__qPortal=!0,_e(e.proxy,"contentEl",()=>t.value),{showPortal:m,hidePortal:f,portalIsActive:s,portalIsAccessible:u,renderPortal:()=>d===!0?n():s.value===!0?[x(Ve,{to:r},x(tt,n))]:void 0}}let H=0,I,U,F,G=!1,ne,se,re,b=null;function it(e){nt(e)&&Me(e)}function nt(e){if(e.target===document.body||e.target.classList.contains("q-layout__backdrop"))return!0;const t=ze(e),n=e.shiftKey&&!e.deltaX,o=!n&&Math.abs(e.deltaX)<=Math.abs(e.deltaY),s=n||o?e.deltaY:e.deltaX;for(let u=0;u<t.length;u++){const r=t[u];if(Ue(r,o))return o?s<0&&r.scrollTop===0?!0:s>0&&r.scrollTop+r.clientHeight===r.scrollHeight:s<0&&r.scrollLeft===0?!0:s>0&&r.scrollLeft+r.clientWidth===r.scrollWidth}return!0}function ae(e){e.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function M(e){G!==!0&&(G=!0,requestAnimationFrame(()=>{G=!1;const{height:t}=e.target,{clientHeight:n,scrollTop:o}=document.scrollingElement;(F===void 0||t!==window.innerHeight)&&(F=n-t,document.scrollingElement.scrollTop=o),o>F&&(document.scrollingElement.scrollTop-=Math.ceil((o-F)/8))}))}function ue(e){const t=document.body,n=window.visualViewport!==void 0;if(e==="add"){const{overflowY:o,overflowX:s}=window.getComputedStyle(t);I=je(window),U=Ie(window),ne=t.style.left,se=t.style.top,re=window.location.href,t.style.left=`-${I}px`,t.style.top=`-${U}px`,s!=="hidden"&&(s==="scroll"||t.scrollWidth>window.innerWidth)&&t.classList.add("q-body--force-scrollbar-x"),o!=="hidden"&&(o==="scroll"||t.scrollHeight>window.innerHeight)&&t.classList.add("q-body--force-scrollbar-y"),t.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,y.is.ios===!0&&(n===!0?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",M,w.passiveCapture),window.visualViewport.addEventListener("scroll",M,w.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",ae,w.passiveCapture))}y.is.desktop===!0&&y.is.mac===!0&&window[`${e}EventListener`]("wheel",it,w.notPassive),e==="remove"&&(y.is.ios===!0&&(n===!0?(window.visualViewport.removeEventListener("resize",M,w.passiveCapture),window.visualViewport.removeEventListener("scroll",M,w.passiveCapture)):window.removeEventListener("scroll",ae,w.passiveCapture)),t.classList.remove("q-body--prevent-scroll"),t.classList.remove("q-body--force-scrollbar-x"),t.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,t.style.left=ne,t.style.top=se,window.location.href===re&&window.scrollTo(I,U),F=void 0)}function st(e){let t="add";if(e===!0){if(H++,b!==null){clearTimeout(b),b=null;return}if(H>1)return}else{if(H===0||(H--,H>0))return;if(t="remove",y.is.ios===!0&&y.is.nativeMobile===!0){b!==null&&clearTimeout(b),b=setTimeout(()=>{ue(t),b=null},100);return}}ue(t)}function rt(){let e;return{preventBodyScroll(t){t!==e&&(e!==void 0||t===!0)&&(e=t,st(t))}}}const T=[];let E;function at(e){E=e.keyCode===27}function ut(){E===!0&&(E=!1)}function dt(e){E===!0&&(E=!1,Ae(e,27)===!0&&T[T.length-1](e))}function ve(e){window[e]("keydown",at),window[e]("blur",ut),window[e]("keyup",dt),E=!1}function ct(e){y.is.desktop===!0&&(T.push(e),T.length===1&&ve("addEventListener"))}function de(e){const t=T.indexOf(e);t!==-1&&(T.splice(t,1),T.length===0&&ve("removeEventListener"))}const k=[];function pe(e){k[k.length-1](e)}function ft(e){y.is.desktop===!0&&(k.push(e),k.length===1&&document.body.addEventListener("focusin",pe))}function ce(e){const t=k.indexOf(e);t!==-1&&(k.splice(t,1),k.length===0&&document.body.removeEventListener("focusin",pe))}let z=0;const mt={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},fe={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]};var yt=me({name:"QDialog",inheritAttrs:!1,props:{...Ye,...Je,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,backdropFilter:String,position:{type:String,default:"standard",validator:e=>["standard","top","bottom","left","right"].includes(e)}},emits:[...Ne,"shake","click","escapeKey"],setup(e,{slots:t,emit:n,attrs:o}){const s=N(),u=B(null),r=B(!1),a=B(!1);let d=null,m=null,f,v;const p=g(()=>e.persistent!==!0&&e.noRouteDismiss!==!0&&e.seamless!==!0),{preventBodyScroll:P}=rt(),{registerTimeout:S}=Re(),{registerTick:_,removeTick:C}=Xe(),{transitionProps:V,transitionStyle:i}=et(e,()=>fe[e.position][0],()=>fe[e.position][1]),h=g(()=>i.value+(e.backdropFilter!==void 0?`;backdrop-filter:${e.backdropFilter};-webkit-backdrop-filter:${e.backdropFilter}`:"")),{showPortal:Z,hidePortal:J,portalIsAccessible:he,renderPortal:ge}=lt(s,u,Pe,"dialog"),{hide:$}=Ze({showing:r,hideOnRouteChange:p,handleShow:ke,handleHide:Se,processOnMount:!0}),{addToHistory:ye,removeFromHistory:we}=Ge(r,$,p),be=g(()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${e.maximized===!0?"maximized":"minimized"} q-dialog__inner--${e.position} ${mt[e.position]}`+(a.value===!0?" q-dialog__inner--animating":"")+(e.fullWidth===!0?" q-dialog__inner--fullwidth":"")+(e.fullHeight===!0?" q-dialog__inner--fullheight":"")+(e.square===!0?" q-dialog__inner--square":"")),D=g(()=>r.value===!0&&e.seamless!==!0),xe=g(()=>e.autoClose===!0?{onClick:qe}:{}),Te=g(()=>[`q-dialog fullscreen no-pointer-events q-dialog--${D.value===!0?"modal":"seamless"}`,o.class]);A(()=>e.maximized,l=>{r.value===!0&&W(l)}),A(D,l=>{P(l),l===!0?(ft(R),ct(K)):(ce(R),de(K))});function ke(l){ye(),m=e.noRefocus===!1&&document.activeElement!==null?document.activeElement:null,W(e.maximized),Z(),a.value=!0,e.noFocus!==!0?(document.activeElement!==null&&document.activeElement.blur(),_(L)):C(),S(()=>{if(s.proxy.$q.platform.is.ios===!0){if(e.seamless!==!0&&document.activeElement){const{top:c,bottom:q}=document.activeElement.getBoundingClientRect(),{innerHeight:te}=window,Q=window.visualViewport!==void 0?window.visualViewport.height:te;c>0&&q>Q/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-Q,q>=te?1/0:Math.ceil(document.scrollingElement.scrollTop+q-Q/2))),document.activeElement.scrollIntoView()}v=!0,u.value.click(),v=!1}Z(!0),a.value=!1,n("show",l)},e.transitionDuration)}function Se(l){C(),we(),ee(!0),a.value=!0,J(),m!==null&&(((l&&l.type.indexOf("key")===0?m.closest('[tabindex]:not([tabindex^="-"])'):void 0)||m).focus(),m=null),S(()=>{J(!0),a.value=!1,n("hide",l)},e.transitionDuration)}function L(l){Qe(()=>{let c=u.value;if(c!==null){if(l!==void 0){const q=c.querySelector(l);if(q!==null){q.focus({preventScroll:!0});return}}c.contains(document.activeElement)!==!0&&(c=c.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||c.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||c.querySelector("[autofocus], [data-autofocus]")||c,c.focus({preventScroll:!0}))}})}function O(l){l&&typeof l.focus=="function"?l.focus({preventScroll:!0}):L(),n("shake");const c=u.value;c!==null&&(c.classList.remove("q-animate--scale"),c.classList.add("q-animate--scale"),d!==null&&clearTimeout(d),d=setTimeout(()=>{d=null,u.value!==null&&(c.classList.remove("q-animate--scale"),L())},170))}function K(){e.seamless!==!0&&(e.persistent===!0||e.noEscDismiss===!0?e.maximized!==!0&&e.noShake!==!0&&O():(n("escapeKey"),$()))}function ee(l){d!==null&&(clearTimeout(d),d=null),(l===!0||r.value===!0)&&(W(!1),e.seamless!==!0&&(P(!1),ce(R),de(K))),l!==!0&&(m=null)}function W(l){l===!0?f!==!0&&(z<1&&document.body.classList.add("q-body--dialog"),z++,f=!0):f===!0&&(z<2&&document.body.classList.remove("q-body--dialog"),z--,f=!1)}function qe(l){v!==!0&&($(l),n("click",l))}function Ee(l){e.persistent!==!0&&e.noBackdropDismiss!==!0?$(l):e.noShake!==!0&&O()}function R(l){e.allowFocusOutside!==!0&&he.value===!0&&Ke(u.value,l.target)!==!0&&L('[tabindex]:not([tabindex="-1"])')}Object.assign(s.proxy,{focus:L,shake:O,__updateRefocusTarget(l){m=l||null}}),Y(ee);function Pe(){return x("div",{role:"dialog","aria-modal":D.value===!0?"true":"false",...o,class:Te.value},[x(le,{name:"q-transition--fade",appear:!0},()=>D.value===!0?x("div",{class:"q-dialog__backdrop fixed-full",style:h.value,"aria-hidden":"true",tabindex:-1,onClick:Ee}):null),x(le,V.value,()=>r.value===!0?x("div",{ref:u,class:be.value,style:i.value,tabindex:-1,...xe.value},Oe(t.default)):null)])}return ge}});export{yt as Q,Xe as u};
